<app-card class="post-card">
    <div class="post-header">
        <div class="post-author-info">
            <div class="post-avatar">
                @if (post().author?.avatar_url) {
                <img [src]="post().author?.avatar_url">
                } @else {
                <span>{{ (post().author?.username?.charAt(0) || '?') }}</span>
                }
            </div>
            <div class="post-meta">
                <div class="post-meta__name" [routerLink]="['/u', post().author?.username]">
                    {{ post().author?.display_name || post().author?.username }}
                </div>
                <div class="post-meta__details">
                    {{'@'}}{{ post().author?.username }} â€¢ {{ post().created_at | date:'short' }}
                </div>
            </div>
        </div>
    </div>

    <div class="post-body">
        <p>{{ post().content }}</p>

        @if (post().image_url) {
        <div class="post-image">
            <img [src]="post().image_url" loading="lazy">
        </div>
        }
    </div>

    <div class="post-actions">
        <button (click)="onLike()" class="action-btn" [class.action-btn--active]="isLiked">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path
                    d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />
            </svg>
            {{ post().likes_count }}
        </button>

        <button (click)="toggleComments()" class="action-btn" [class.action-btn--active]="showComments()">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z" />
            </svg>
            {{ post().comments_count }}
        </button>
    </div>

    <!-- Comment Section -->
    @if (showComments()) {
    <app-comment-section [postId]="post().id" />
    }
</app-card>